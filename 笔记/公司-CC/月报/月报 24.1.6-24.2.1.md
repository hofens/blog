# [月报][火星安卓组]黄厚锋(24.1.6-24.2.1)

hi all,

        本月工作内容如下


## 本月工作内容

### CC直播业务


#### [#745102](https://icc.pm.netease.com/v6/issues/745102) 【IM 模块】第一期群基础功能和消息类型搭建-家族群框架

顶部
- 增加协议监听 免打扰 设置变更
- 在线人数变更逻辑调整
- 限制群名宽度
- 增加群信息修改监听
- 打开 h 5 页面，增加隐藏关闭按钮参数
 
通告
- 优化数据判空，避免服务端不传或传""情况
- 限制通告可显示版本
- 群公告限制点击区域为按钮
- 修改通告样式

玩法中心
- 点击列表收起玩法弹窗
- 修改 openType 半屏/全屏对应值

代码优化
- 优化从intent获参方式，viewmodel改为绑定fragment
- 监听顶号处理
- 拆分群聊abstractChatFragment
- FamilyFragment添加逻辑优化，去除FragmentPageAdapter
- 发言增加加载中状态

前端接口
- 提供前端 拍照 接口
- 提供前端 唤起举报弹窗 接口

#### [#748802](https://icc.pm.netease.com/v6/issues/748802)【IM模块】第一期群基础功能和消息类型搭建 埋点

群聊天界面曝光  
聊天页面-顶部条点击  
底部工具条点击  
活动玩法曝光/点击  
通告栏曝光/点击



#### [#749932](https://icc.pm.netease.com/v6/issues/749932) 【IM 模块】第2期群互动送礼/红包

消息长按
- 删除
    - 所有消息类型增加删除功能
    - 本地过滤已删除消息
    - 增加本地删除消息接口
    - 删除二次确认弹窗 UI、功能实现
    - 调整删除确认弹窗 style
- 复制
    - 文字消息增加举报功能
- 举报
    - 文字、相册增加举报功能

发言
- 发言代码优化去除map操作
- 拆分本地插入消息与发送到服务端
- 发送@消息
- 消息卡片 @用户展示 UI
- at 消息自己发的不高亮

礼物功能
- 选择送礼用户
    - 调用前端成员页选择待送礼用户
    - 前端获参、传参接口联调
    - 优化intent传对象字段
- 接口
    - 修改获取家族礼物配置接口
    - 增加家族送礼接口
    - 增加礼物特效、横幅广播接口监听
- 特效
    - 横幅队列处理
    - 多人场景横幅展示逻辑修改
- 礼物架
	- 提供消息点击打开礼物架接口
	- 优化调起礼物架传参方式
	- 送礼用户昵称长度限制
	- 选择完送礼用户后不主动 finish 网页
	- 增加最多可送礼用户字段解析
- 接口增加 gametype 过滤可见礼物
- 群聊礼物特效铺满宽度等比缩放
- 修改原私聊礼物架魔法值使用
- 家族群礼物架改为独立实现

通告栏样式修改  
唤起相册增加权限请求  
历史消息翻页改 http 请求  
保存图片后 MediaScannerConnection 来通知系统已添加新图像
处理多个相同 groupId 打开的情况，销毁旧的 Activity，避免多实例情况出现

#### [#752534](https://icc.pm.netease.com/v6/issues/752534) 【IM 模块】第 2 期群互动送礼/红包埋点
替换群身份取值为英文

家族群聊天界面曝光埋点增加字段  
增加消息长按点击埋点  
增加底部工具条点击埋点字段  
增加底部礼物 icon-曝光埋点  
支持 cc协议透传埋点

礼物面板曝光点击  
余额不足页面曝光点击  
增加 C 豆余额不足曝光上报  
钱包点击  
送礼对象点击  
增加礼物连击埋点

#### [#750382](https://icc.pm.netease.com/v6/issues/750382) 家族用户路径及玩法承接-一期-从玩法退出后进入家族，领取首次奖励-安卓

#751658 家族群增加新人礼包弹窗，增加群过滤
#752055 新增获取家族群小插件边距 jsmethod 接口


#### [#752147](https://icc.pm.netease.com/v6/issues/#752147) 游戏语音品类重上人气心功能

回退删除代码  
人气心插件调整尺寸移至可滑动容器中

### 其它

#753778 2024.1.29-2024.2.2 Android 值班
- #753763 【回归 2024.01.31】Android-星秀开播，送出的第一个礼物，其公屏消息一直固定在底部，不会被新消息顶上去。
- #753773 【回归 2024.01.31】Android-我要开播-星秀-主播侧公屏不显示铭牌
- 星秀-视频右下角区域精彩圈子不显示


### 总结

[#745102](https://icc.pm.netease.com/v6/issues/745102) 【IM 模块】第一期群基础功能和消息类型搭建-家族群框架
[#748802](https://icc.pm.netease.com/v6/issues/748802) 【IM 模块】第一期群基础功能和消息类型搭建埋点
[#749932](https://icc.pm.netease.com/v6/issues/749932) 【IM 模块】第 2 期群互动送礼/红包
[#752534](https://icc.pm.netease.com/v6/issues/752534) 【IM 模块】第 2 期群互动送礼/红包埋点
[#750382](https://icc.pm.netease.com/v6/issues/750382) 家族用户路径及玩法承接-一期-从玩法退出后进入家族，领取首次奖励-安卓
[#752147](https://icc.pm.netease.com/v6/issues/#752147) 游戏语音品类重上人气心功能